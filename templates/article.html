{% extends 'base.html' %}

{% block content %}

{% if article %}
<h2>{{ article.title }}</h2>

<div id="view-post">
	{% if article.answered %}
	<h3>ANSWERED</h3>
	{% endif %}
	<p>{{ article.body }}</p>
	<p class="view-post-info">
	Likes: {{ article.likes }} |<a href="/like/{{ article.id }}">Like</a><br>	
	Posted {{ article.pub_date }}
	</p>
	<p><div class="fake-button show-comment-main">Comment on this</div></p>	
	<ul class="post-list">
		{% for comment in article.comments.all %}			
			<li>
				<div class="post">
					<p>{{ comment.body }}</p>
					<div class="post-info">
						{{ comment.pub_date }}<br>
						Likes: {{ comment.likes }} |<a href="/like_comment/{{ comment.id }}">Like</a>
					</div>						
				</div>
			</li>
		{% endfor %}
	<form id="comment-form" class="comment-form-main hidden" action="/comment/{{ article.id }}/" method="POST">
		{% csrf_token %}
		<ul>
			{{ comment_form.as_ul }}
			<input type="hidden" name="article" value="{{ article.id }}" />
		</ul>
		<input type="submit" name="submit" value="Save Comment" />	
	</form><!-- End Make comment form -->		
</ul>
{% else %}
	<p>No matching post found in database</p>
{% endif %}
</div>
{% if article %}
<h3>Answers</h3>
	<ul class="post-list">
		{% for answer in article.answers.all %}
			{% if answer.is_answer %}
				<li class="answer">
			{% else %}
				<li>
			{% endif %}
				<div class="post">
					<p>{{ answer.body }}</p>
					<div class="post-info">
						{{ answer.pub_date }}<br>
						Likes: {{ answer.likes }} |<a href="/like_comment/{{ comment.id }}">Like</a>
					</div>
					{% if article.posted_by == user and not answer.is_answer %}
						<div class="accept-answer"><a href="/accept_answer/{{ answer.id }}">Accept Answer</a> {{ answer.is_answer }}</div>
					{% endif %}
					
						<ul class="post-list">
		{% for comment in answer.comments.all %}			
				<li>

				<div class="post">
					<p>{{ comment.body }}</p>
					<div class="post-info">
						{{ comment.pub_date }}<br>
						Likes: {{ comment.likes }} |<a href="/like_comment/{{ comment.id }}">Like</a>
					</div>						
				</div>
			</li>
		{% endfor %}
		</ul>
					
					
					<p><div class="fake-button show-comment-2">Comment on this</div></p>
						<form id="comment-form" class="comment-form-2 hidden" class="" action="/commenta/{{ answer.id }}/" method="POST">
						{% csrf_token %}
						<ul>
							{{ comment_form.as_ul }}
							<input type="hidden" name="article" value="{{ article.id }}" />
						</ul>
						<input type="submit" name="submit" value="Save Comment" />	
					</form><!-- End Make comment form -->	
				</div>
			</li>
		{% endfor %}	
</ul>
<h2>Post an Answer</h2>
	<form id="answer-form" action="/answer/{{ article.id }}/" method="POST">
		{% csrf_token %}
		<ul>
			{{ answer_form.as_ul }}
			<input type="hidden" name="article" value="{{ article.id }}" />
		</ul>
		<input type="submit" name="submit" value="Save Comment" />	
	</form><!-- End Make answer form -->
{% endif %}
{% endblock %}

